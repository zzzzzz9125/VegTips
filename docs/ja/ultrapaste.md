---
layout: doc
title: UltraPaste! 拡張機能
---

<style scoped>
:deep(div[class*="language-"]) pre,
:deep(div[class*="language-"]) code {
  word-break: break-all !important;
  white-space: pre-wrap !important;
}

:deep(p) code,
:deep(li) code,
:deep(td) code {
  word-break: break-all;
  white-space: pre-wrap;
}

:deep(.vp-doc) {
  word-break: normal;
  overflow-wrap: break-word;
}
</style>

# UltraPaste! 拡張機能

<ImageOnDemand alt="アイコン" src="ultrapaste/img001_ultrapaste_icon.png" />

## 概要

この拡張機能は、VEGAS Pro に**<u>画期的な</u>**ファイルインポート方法を導入します。たった一つのホットキーで、ほぼすべてのタイプのファイルをインポートできます：通常のメディアファイル、クリップボードからの画像、SRT 字幕ファイル、さらには REAPER のクリップボードデータまで。`Ctrl + C`、次に `Ctrl + Shift + V` を押すだけで、これらのファイルを VEGAS のタイムラインに素早くインポートできます。

メディアファイルのインポート方法の例：

<ImageOnDemand alt="メディアインポート" src="ultrapaste/img015_ultrapaste_media_import.gif" />

`クリップボード画像`機能とスクリーンショットツールとの連携：

<ImageOnDemand alt="スクリーンショット" src="ultrapaste/img016_ultrapaste_screenshot.gif" />

`クリップボード画像`機能と PowerPoint との連携：

<ImageOnDemand alt="PowerPoint" src="ultrapaste/img017_ultrapaste_ppt.gif" />

## インストール

現在の拡張機能バージョン：v1.03 beta

対応バージョン：Sony Vegas Pro 13 - Magix Vegas Pro 22

1.  [Releases](https://github.com/zzzzzz9125/UltraPaste/releases) から最新の .zip ファイルをダウンロードし、解凍します。`UltraPaste.dll`<small>（`Sony VEGAS Pro 13` の場合は `UltraPaste_13.dll`）</small>と `UltraPaste.png` を選択し、コピーして拡張機能フォルダに貼り付けます：
  - `C:\ProgramData\Vegas Pro\Application Extensions\`
  - または Sony 版の場合：`C:\ProgramData\Sony\Vegas Pro\Application Extensions\`
  - 拡張機能のインストール方法がわからない場合は、[こちら](/ja/#スクリプトまたは拡張機能をインストールする一般的な手順)をクリックしてください。

2.  インストール後、`ツール -> UltraPaste!` からドッキング可能な拡張機能ウィンドウを見つけることができます。

<ImageOnDemand alt="ツールメニュー" src="ultrapaste/img002_ultrapaste_tools_menu.png" />

## 使用方法

まずは最上位の `UltraPaste!` です。これは拡張機能の主要な機能で、ほとんどすべての操作はこれを使用して完了できます。`オプション -> カスタマイズキーボード` でキーボードショートカットを割り当てることができます：

<ImageOnDemand alt="カスタマイズキーボード" src="ultrapaste/img003_ultrapaste_keyboard.png" />

`Ctrl + Shift + V` は私の個人的なおすすめです。他の便利なショートカットをバインドすることもできます。VEGAS のネイティブな貼り付けキーを上書きするため、`Ctrl + V` をバインドすることはお勧めしません。

これで UltraPaste キーのショートカットがバインドされました。メニューに表示されるすべてのワンクリック操作機能も、この方法でショートカットを追加できます。

ファイルのインポートロジックは単純です：例えば、デスクトップ上の任意のメディアファイルを選択し、`Ctrl + C` でコピーし、VEGAS 内で `UltraPaste` ショートカットを実行すると、現在選択されている VEGAS トラックにインポートされます。さらに、VEGAS でループ領域を定義している場合、ファイルはそのループ領域の長さに従ってインポートできます。

基本的なファイルインポート以外にも、この拡張機能は以下のクリップボードデータタイプを読み取ることができます：
*   クリップボード画像
*   プレーンテキストと字幕ファイル
*   REAPER クリップボードデータ

これらすべてのデータは正しく認識・処理されます。

<br>

`UltraPaste! - ウィンドウ` は拡張機能の設定ウィンドウで、ここで `UltraPaste` の動作ロジックを調整できます。

### 一般

<ImageOnDemand alt="一般" src="ultrapaste/img004_ultrapaste_general.png" />

除外ファイルタイプ：このオプションは、特定の名前パターンに一致するファイルを拡張機能が除外するようにします。基本的な DOS ワイルドカード式を使用します。例えば、画像内の `*.sfvp0` と `*.sfap0` は、それぞれ VEGAS Pro のビデオプロキシファイルとオーディオプロキシファイルです。これらのプロキシファイルは実際には VEGAS に直接インポートできますが、ユーザーの誤操作を防ぐためにデフォルトで除外されています。特定のファイルをインポートする必要がない場合は、この設定を自分で調整できます。

<br>

### クリップボード画像

<ImageOnDemand alt="クリップボード画像" src="ultrapaste/img005_ultrapaste_clipboard_image.png" />

`開始位置`：ファイルインポートの開始位置。`カーソル`、`再生カーソル`、`プロジェクト開始位置`の3つのカテゴリに分けられます。`カーソル`と`再生カーソル`の違いは、タイムラインを再生するとき、`カーソル`は単なる再生開始点ですが、`再生カーソル`はタイムラインのリアルタイム再生位置です。

`カーソルを末尾に移動`：貼り付け動作を模倣し、貼り付け後に自動的にカーソルを新規イベントの末尾に移動します。

`保存パス`：VEGAS はファイルを空から埋め込むことはできません。すべてのメディアファイルは実際の場所に保存する必要があります。クリップボード画像の保存パスを設定する必要があります。

*   デフォルト値：`Clipboard\<yyyyMMdd_HHmmss>.png`。これは `%PROJECTFOLDER%\Clipboard\<yyyyMMdd_HHmmss>.png` に相当します。ここで、`%PROJECTFOLDER%` は現在のプロジェクトファイルのフォルダパスを指します。<small>（プロジェクトが保存されていない場合、デフォルトはデスクトップパスです。）</small>
*   `<yyyyMMdd_HHmmss>` はファイルを保存するタイムスタンプの形式を指します。ここでは、タイムスタンプに変換する必要があるパスの部分は `<>` で囲む必要があると厳密に指定しています。そうしないと、拡張機能は変換しません。
    *   その他のタイムスタンプ書式設定の構文については、以下を参照してください：https://learn.microsoft.com/dotnet/api/system.datetime.tostring

<br>

### REAPER データ

<ImageOnDemand alt="Reaper データ" src="ultrapaste/img006_ultrapaste_reaper_data.png" />

これはこの拡張機能の重要な機能の1つです：REAPER クリップボードデータのインポートとエクスポートを完全に実装しました。REAPER でさまざまなアイテムやトラックを選択し、`Ctrl + C` を押した後、直接 `Ctrl + Shift + V` で VEGAS タイムラインに貼り付けることができます。

拡張機能は2つのソフトウェア間のさまざまなパラメータを適応させます：
*   `REAPER アイテムプロパティ` → `VEGAS イベントプロパティ`
*   `REAPER アイテム/トラックエンベロープ` → `VEGAS トラックエンベロープ`
*   `REAPER アイテムストレッチマーカー` → `VEGAS オーディオイベントストレッチ / ビデオイベント速度エンベロープ`
*   `REAPER トラックプロパティ` → `VEGAS トラックプロパティ`
*   ...

要するに、適応可能なものはすべて適応されています。REAPER プロジェクトファイルを選択し、`Ctrl + C` を押して、複数のトラックとしてインポートすることもできます。

VEGAS イベントやトラックを REAPER クリップボードデータとしてエクスポートし、REAPER で `Ctrl + V` を押して、ソフトウェア間の完全な相互運用性を実現することもできます。

<ImageOnDemand alt="Reaper 例 1" src="ultrapaste/img007_ultrapaste_reaper_1.png" />

<ImageOnDemand alt="Reaper 例 2" src="ultrapaste/img008_ultrapaste_reaper_2.png" />

注意：スクリプティング API の制限により、VEGAS のバージョンが 15 の最終版 `VP15B416` より古い場合、オーディオイベントのピッチに関連するすべてのパラメータは VEGAS に転送できず、REAPER クリップボードデータに出力することもできません。

`先頭の間隔を詰める`：REAPER クリップボードデータには、元のアイテムの REAPER プロジェクト内での絶対位置が含まれます。「先頭の間隔を詰める」がオフの場合、貼り付け開始位置 = REAPER プロジェクト開始位置。「先頭の間隔を詰める」がオンの場合、貼り付け開始位置 = 最初のアイテムの開始位置。

`ビデオストリームを追加`：インポートされた REAPER アイテムにビデオストリームを追加します。

<br>

### PSD 画像

<ImageOnDemand alt="PSD 画像" src="ultrapaste/img009_ultrapaste_psd.png" />

`すべてのレイヤーを展開`：マルチレイヤーの PSD 画像をインポートするとき、自動的に別々の VEGAS トラックに展開します。

`他のレイヤーを追加`：選択された単一の PSD レイヤーに対して、その上と下にある他のすべてのレイヤーを補完します。

<br>

### 字幕

<ImageOnDemand alt="字幕" src="ultrapaste/img010_ultrapaste_subtitles.png" />

字幕はこの拡張機能のもう一つの重要な機能です。任意の `プレーンテキスト` / `TXT` ファイル / `SRT` 字幕ファイル / `LRC` 字幕ファイルをコピーして VEGAS タイムラインに貼り付けることができます。

`ジェネレータータイプ`：字幕ジェネレーターのタイプ。

`プリセット名`：使用したい字幕ジェネレーターのプリセット名。対応する FX 内であらかじめプリセットを調整して保存しておく必要があります。

DXT タイプのプラグインである `ProType Titler` と `(Legacy) Text` については、ユーザーが保存したプリセットのみ認識され、VEGAS に組み込まれているプリセットはサポートされていません。<small>（使用したい場合は、名前を変更して再保存するだけです。）</small>

`リージョン`：字幕を VEGAS リージョンとしてインポートします。

`最大文字数`：一行の文字数が指定された数を超えた場合、自動的に改行します。0 は文字数の制限がないことを意味します。

`単語を無視`：チェックを外すと、拡張機能はスペースによる単語の区切りを最適化します。つまり、単語全体を強制的に分割せず、スペースの位置で改行を試みます。もちろん、スペースを通常使用しない中国語などの言語の場合は、このボックスを直接チェックすると、文字数に従って厳密に分割されます。

`最大行数`：1つの字幕ブロックの行数が一定数を超えた場合、自動的に新しい字幕ブロックに分割します。分割後の長さは元のブロックから均等に分割されます。

`マルチトラック`：1つの字幕ブロック内の複数行を複数のトラックに分割します。注意：拡張機能はこれらの複数のトラックに対して位置調整を一切適用しないため、そのような字幕はプレビューウィンドウで重なって表示され、手動での調整が必要です。

`デフォルト長`：タイムスタンプのないクリップボードプレーンテキストや TXT ファイルをインポートするときのデフォルトの長さ（秒）。

<ImageOnDemand alt="字幕リージョン" src="ultrapaste/img011_ultrapaste_subtitles_region.png" />

<p align="center">ヒント：タイムライン上であらかじめリージョンを定義してからショートカットキーを押すと、より便利です。</p>

`プリセットを選択したイベントに適用`：現在のプリセットを選択したイベントに適用します。OFX エフェクトのみサポートし、`ProType Titler` と `(Legacy) Text` はサポートしません。

`T&T を ProType Titler に変換`：選択した「タイトルとテキスト」イベントをワンクリックで `ProType Titler` イベントに変換します。

<br>

### メディア

<ImageOnDemand alt="メディア" src="ultrapaste/img012_ultrapaste_media.png" />

`追加方法`：`時間軸に沿って`、`トラックに沿って`、`テイクとして`の3種類に分けられます。VEGAS ネイティブの右クリックドラッグインポートメニューにある3つのファイルインポート方法と完全に一致します。

`ストリームタイプ`：`すべて`、`ビデオのみ`、`オーディオのみ`の3種類に分けられます。

`イベント長`：`メディア長`、`ループ`、`ループ平均`の3種類に分けられます。`ループ平均`は追加方法が`時間軸に沿って`のときのみ有効です。

`画像シーケンスを自動インポート`：拡張機能がユーザーが画像シーケンスをインポートしていると検出した場合（例えば、選択されたすべての画像ファイルの命名ロジックが `000000.png - 114514.png` のようで、画像の寸法が同一である場合）、自動的に画像シーケンスとしてインポートします。

`不足ストリームを追加`：選択したイベントに不足しているストリームを追加します。

<br>

メディアカスタムインポート：

<ImageOnDemand alt="メディアカスタムインポート" src="ultrapaste/img013_ultrapaste_media_custom.png" />

<p align="center">特定のメディアファイル名に対してインポートルールを設定</p>

カスタマイズにより、特定のメディアファイル名に対して特別なインポートルールを設定できます。変更後、`√`をクリックすると設定に保存されます。不要になった設定は、`×`を押して削除できます。

<small>ここの UI ロジックは少し融通が利きません。ファイルルール文字列がキー名として使用されているため、ファイル名を変更するには、まず削除し、再入力して変更する必要があります。そうしないと、元のものが削除されません。</small>

例えば、私の `1_*(*).wav;1_*(*).flac` は、[UVR5](https://github.com/Anjok07/ultimatevocalremovergui) が出力するステムファイルの命名規則を指します。ここでは、オーディオのみを「トラックに沿って」の方法でインポートするように要求します。その後、フォルダ内でステムファイルを複数選択し、`Ctrl + C` を押し、`UltraPaste!` ショートカットキーを押すと、[UVR5](https://github.com/Anjok07/ultimatevocalremovergui) ステムを直接インポートできます。

<br>

### VEGAS データ

<ImageOnDemand alt="VEGAS データ" src="ultrapaste/img014_ultrapaste_vegas_data.png" />

`VEG インポートタイプ`：`プロジェクトファイルを開く`、`ネストされたプロジェクトとしてインポート`、`プロジェクトからメディアをインポート`の3種類に分けられます。

`イベント属性を貼り付け`：クリップボードデータに VEGAS イベントが含まれている場合、`選択的イベント属性貼り付け`を実行します。

（バージョン制限のため、VEGAS Pro 14 以下では `選択的イベント属性貼り付け` を使用できず、`イベント属性を貼り付け` のみ実行できます。）

`スクリプトを実行`：コピーしたファイルに `.cs` / `.js` / `.vb` / `.dll` ファイルが含まれている場合、それらをスクリプトとして実行しようとします。実行に失敗すると直接エラーが報告されるため、このオプションを有効にする場合は、`.dll` ファイルなどを無作為にコピーして貼り付けないようにしてください。

`混合 VEGAS クリップボードデータを生成`：一般ユーザーにはあまり役に立ちません。ただし、Sony 版（Sony VEGAS Pro 13 以下）と高バージョンの両方を使用している場合、このワンクリック操作により、クリップボードデータ内の VEGAS イベントが Sony 版と Magix 版の両方で貼り付け可能なバージョンに変換されます。実験的な機能であり、完全に信頼できるものではありません。
